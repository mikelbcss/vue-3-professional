# ðŸ§° Buenas prÃ¡cticas y herramientas

En este mÃ³dulo exploraremos patrones, herramientas y flujos de trabajo que te ayudarÃ¡n a construir y mantener aplicaciones Vue 3 profesionales. A continuaciÃ³n tienes guÃ­as prÃ¡cticas y listas para copiar/pegar para estandarizar tu proyecto.

## ðŸŽ¯ Objetivos del mÃ³dulo

- Adoptar convenciones y patrones de cÃ³digo consistentes
- Configurar herramientas de calidad (lint, format, type-check)
- Mejorar DX con utilidades de desarrollo y depuraciÃ³n
- Optimizar builds y rendimiento en producciÃ³n

---

## ðŸ§¹ ESLint + Prettier (lint y formateo)

Usamos ESLint para reglas de calidad de cÃ³digo y Prettier para formateo consistente. Esta combinaciÃ³n es estÃ¡ndar en el ecosistema Vue/TypeScript y se integra con Vite sin fricciÃ³n.

- ConfiguraciÃ³n relevante:
  - `eslint.config.ts` (flat config) con `eslint-plugin-vue`, `typescript-eslint` y `eslint-config-prettier` para desactivar reglas de estilo en conflicto.
  - `.prettierrc.json` con las reglas de formato del proyecto.

- Scripts en `package.json`:

```json
{
  "scripts": {
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "format": "prettier --write --ignore-path .gitignore .",
    "format:check": "prettier --check --ignore-path .gitignore ."
  }
}
```

- Uso recomendado:

```bash
npm run lint
npm run lint:fix
npm run format
npm run format:check
```

Consejo: ejecuta ESLint y Prettier en los hooks de Git para asegurar consistencia en cada commit (ver secciÃ³n Lefthook).

---

## ðŸ§ª TypeScript (tipado estricto + verificaciÃ³n fuera del bundler)

Para Vue 3, usa `vue-tsc` para validar tipos sin depender del bundler.

- Script ya configurado:

```json
{
  "scripts": { "typecheck": "vue-tsc -b" }
}
```

- Recomendaciones de `tsconfig` (extracto):

```jsonc
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "jsx": "preserve",
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "useDefineForClassFields": true,
    "verbatimModuleSyntax": true,
    "types": ["node", "vite/client"],
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
    },
  },
}
```

- VerificaciÃ³n manual y continua:

```bash
npm run typecheck
```

Sugerencia: aÃ±Ã¡delo al pipeline de CI para fallar builds con errores de tipos.

---

## âš¡ Vite (DX rÃ¡pida y builds eficientes)

Vite ya estÃ¡ configurado en este proyecto. Buenas prÃ¡cticas comunes:

- Usa el plugin oficial de Vue y alias `@` a `src`.
- Gestiona variables con ficheros `.env` y prefijo `VITE_`.
- Activa `sourcemap` en build para diagnÃ³sticos de producciÃ³n cuando sea necesario.

Ejemplo de `vite.config.ts` mÃ­nimo:

```text
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'node:path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: { '@': path.resolve(__dirname, 'src') },
  },
  build: {
    sourcemap: false,
    target: 'es2020',
  },
  server: {
    port: 5173,
  },
})
```

Variables de entorno: crea `.env`, `.env.local`, `.env.production` y usa `import.meta.env.VITE_LO_QUE_SEA`.

---

## ðŸª Lefthook (hooks de Git rÃ¡pidos y reproducibles)

Este proyecto incluye `lefthook.yml` para ejecutar comprobaciones en cada commit.

- InstalaciÃ³n de hooks en tu repo local:

```bash
npx lefthook install
```

- ConfiguraciÃ³n actual (extracto):

```yaml
pre-commit:
  commands:
    format:
      glob: '*.{js,ts,cjs,mjs,d.cts,d.mts,vue,jsx,tsx,json,jsonc,md,mdx}'
      run: npx prettier --write --ignore-path .gitignore {staged_files}
      stage_fixed: true
    lint:
      glob: '*.{js,ts,cjs,mjs,d.cts,d.mts,vue,jsx,tsx}'
      run: npx eslint --fix {staged_files}
      stage_fixed: true
```

Sugerencias adicionales:

```yaml
pre-push:
  commands:
    typecheck:
      run: npm run typecheck
```

---

## ðŸ“Œ Fijar dependencias en `package.json`

Fijar versiones garantiza builds reproducibles. Recomendaciones:

- Usa versiones exactas (sin `^`/`~`). Este proyecto ya las usa.
- Usa `npm ci` en CI para instalar exactamente lo declarado en `package-lock.json`.
- Declara `engines` y (opcional) `packageManager` para alinear la versiÃ³n de Node y npm.
- Usa `overrides` para corregir subâ€‘dependencias vulnerables cuando sea necesario.

Ejemplo:

```jsonc
{
  "engines": { "node": ">=20 <21" },
  "packageManager": "npm@10",
  "overrides": {
    "minimatch": "9.0.5",
  },
}
```

InstalaciÃ³n reproducible en local:

```bash
npm config set save-exact true   # guarda versiones exactas a futuro
rm -rf node_modules package-lock.json
npm install
```

En CI usa:

```bash
npm ci
```

---

## ðŸ¤– CI/CD con GitHub Actions

Configura un pipeline mÃ­nimo para validar calidad y construir la app.

Crea `.github/workflows/ci.yml`:

```yaml
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node: [20]
    steps:
      - uses: actions/checkout@v4

      - name: Use Node.js ${{ matrix.node }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node }}
          cache: 'npm'

      - name: Install dependencies (clean)
        run: npm ci

      - name: Lint
        run: npm run lint

      - name: Typecheck
        run: npm run typecheck

      - name: Build
        run: npm run build
```

Extensiones Ãºtiles:

- AÃ±ade un job de preview con `actions/upload-artifact` para publicar el `dist/`.
- Ejecuta tests si aÃ±ades Vitest: `npm test` en un paso adicional.

---

## âœ… Checklist rÃ¡pida

- ESLint y Prettier funcionando y ejecutÃ¡ndose en hooks.
- TypeScript estricto y `vue-tsc` en CI.
- Vite con alias y variables de entorno.
- Lefthook instalado en local (`npx lefthook install`).
- Dependencias fijadas y `npm ci` en CI.
- GitHub Actions validando lint, tipos y build.
